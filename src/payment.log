2025-05-22 10:08:20,950 - __main__ - INFO - Firebase initialized successfully
2025-05-22 10:08:20,963 - __main__ - INFO - Starting payment server
2025-05-22 10:09:01,473 - __main__ - INFO - Request facd278e-825a-4e1d-9e1f-626c9a3947cf: Starting payment processing
2025-05-22 10:09:05,683 - __main__ - INFO - Request e657131d-563e-48f6-b6b3-7f7089349c51: Starting payment processing
2025-05-22 10:09:07,090 - __main__ - ERROR - Missing phone number: tutor=None, student=None
2025-05-22 10:09:09,138 - __main__ - ERROR - Missing phone number: tutor=None, student=None
2025-05-22 10:16:12,064 - __main__ - INFO - Request e0d3475c-c1ce-416b-bfdc-77fcdcd34044: Starting payment processing
2025-05-22 10:16:16,808 - __main__ - INFO - Processing payment for lesson ARoQgqIxEPB4jslMEUAQ: 0.22 ZMW from 0981410178 to 0983232144
2025-05-22 10:16:22,684 - __main__ - ERROR - Payment processing failed: HTTPSConnectionPool(host='api.ctechpay.com', port=443): Max retries exceeded with url: /v1/payments/airtel-money (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x000001C312E6B310>: Failed to resolve 'api.ctechpay.com' ([Errno 11001] getaddrinfo failed)"))
2025-05-22 10:16:22,709 - __main__ - ERROR - Request e0d3475c-c1ce-416b-bfdc-77fcdcd34044: Error c021c6fb-9e4b-4a84-bda5-d4ef7b52a747: HTTPSConnectionPool(host='api.ctechpay.com', port=443): Max retries exceeded with url: /v1/payments/airtel-money (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x000001C312E6B310>: Failed to resolve 'api.ctechpay.com' ([Errno 11001] getaddrinfo failed)"))
2025-05-22 10:16:22,957 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connection.py", line 199, in _new_conn
    sock = connection.create_connection(
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\util\connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 11001] getaddrinfo failed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connectionpool.py", line 789, in urlopen
    response = self._make_request(
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connectionpool.py", line 490, in _make_request
    raise new_e
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connectionpool.py", line 466, in _make_request
    self._validate_conn(conn)
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connectionpool.py", line 1095, in _validate_conn
    conn.connect()
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connection.py", line 693, in connect
    self.sock = sock = self._new_conn()
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connection.py", line 206, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPSConnection object at 0x000001C312E6B310>: Failed to resolve 'api.ctechpay.com' ([Errno 11001] getaddrinfo failed)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connectionpool.py", line 843, in urlopen
    retries = retries.increment(
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.ctechpay.com', port=443): Max retries exceeded with url: /v1/payments/airtel-money (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x000001C312E6B310>: Failed to resolve 'api.ctechpay.com' ([Errno 11001] getaddrinfo failed)"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Miles kayler\Documents\ProjectBloom\src\payments.py", line 230, in process_payment
    transaction_data = PaymentProcessor.process_payment(student_phone, tutor_phone, amount, lesson_id)
  File "C:\Users\Miles kayler\Documents\ProjectBloom\src\payments.py", line 140, in process_payment
    response = requests.post(url, json=payload, headers=headers, timeout=10)
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\requests\api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\requests\api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\requests\adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.ctechpay.com', port=443): Max retries exceeded with url: /v1/payments/airtel-money (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x000001C312E6B310>: Failed to resolve 'api.ctechpay.com' ([Errno 11001] getaddrinfo failed)"))

2025-05-22 10:20:04,611 - __main__ - INFO - Request 4272dee6-9c51-4182-83ee-982064da7be3: Starting payment processing
2025-05-22 10:20:08,807 - __main__ - INFO - Processing payment for lesson ARoQgqIxEPB4jslMEUAQ: 0.74 ZMW from 0981410178 to 0983232144
2025-05-22 10:20:08,827 - __main__ - ERROR - Payment processing failed: HTTPSConnectionPool(host='api.ctechpay.com', port=443): Max retries exceeded with url: /v1/payments/airtel-money (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x000001C313130220>: Failed to resolve 'api.ctechpay.com' ([Errno 11001] getaddrinfo failed)"))
2025-05-22 10:20:08,828 - __main__ - ERROR - Request 4272dee6-9c51-4182-83ee-982064da7be3: Error 947cb442-21ac-4e1f-bd69-0005db56555e: HTTPSConnectionPool(host='api.ctechpay.com', port=443): Max retries exceeded with url: /v1/payments/airtel-money (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x000001C313130220>: Failed to resolve 'api.ctechpay.com' ([Errno 11001] getaddrinfo failed)"))
2025-05-22 10:20:08,842 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connection.py", line 199, in _new_conn
    sock = connection.create_connection(
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\util\connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\socket.py", line 955, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 11001] getaddrinfo failed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connectionpool.py", line 789, in urlopen
    response = self._make_request(
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connectionpool.py", line 490, in _make_request
    raise new_e
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connectionpool.py", line 466, in _make_request
    self._validate_conn(conn)
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connectionpool.py", line 1095, in _validate_conn
    conn.connect()
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connection.py", line 693, in connect
    self.sock = sock = self._new_conn()
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connection.py", line 206, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPSConnection object at 0x000001C313130220>: Failed to resolve 'api.ctechpay.com' ([Errno 11001] getaddrinfo failed)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connectionpool.py", line 843, in urlopen
    retries = retries.increment(
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.ctechpay.com', port=443): Max retries exceeded with url: /v1/payments/airtel-money (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x000001C313130220>: Failed to resolve 'api.ctechpay.com' ([Errno 11001] getaddrinfo failed)"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Miles kayler\Documents\ProjectBloom\src\payments.py", line 230, in process_payment
    transaction_data = PaymentProcessor.process_payment(student_phone, tutor_phone, amount, lesson_id)
  File "C:\Users\Miles kayler\Documents\ProjectBloom\src\payments.py", line 140, in process_payment
    response = requests.post(url, json=payload, headers=headers, timeout=10)
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\requests\api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\requests\api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\requests\adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.ctechpay.com', port=443): Max retries exceeded with url: /v1/payments/airtel-money (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x000001C313130220>: Failed to resolve 'api.ctechpay.com' ([Errno 11001] getaddrinfo failed)"))

2025-05-22 10:33:01,224 - __main__ - INFO - Firebase initialized successfully
2025-05-22 10:33:01,226 - __main__ - INFO - Starting payment server
2025-05-22 10:33:57,089 - __main__ - INFO - Request 3a9229b5-70e4-469a-ba6f-0c135a9e3f23: Starting payment processing
2025-05-22 10:34:03,375 - __main__ - INFO - Processing payment for lesson ARoQgqIxEPB4jslMEUAQ: 0.09 ZMW from 0981410178
2025-05-22 10:34:14,670 - __main__ - ERROR - Payment processing failed due to connection error: HTTPSConnectionPool(host='api-sandbox.ctechpay.com', port=443): Max retries exceeded with url: /airtel/access/ (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x0000025D02715C00>: Failed to resolve 'api-sandbox.ctechpay.com' ([Errno 11001] getaddrinfo failed)"))
2025-05-22 10:34:14,704 - __main__ - WARNING - Request 3a9229b5-70e4-469a-ba6f-0c135a9e3f23: Validation error: Failed to connect to payment gateway. Please check network or API endpoint.
2025-05-22 10:36:06,429 - __main__ - INFO - Firebase initialized successfully
2025-05-22 10:36:06,432 - __main__ - INFO - Starting payment server
2025-05-22 10:37:12,327 - __main__ - INFO - Request 4a021c61-c56d-409e-a98a-7a94695d9881: Starting payment processing
2025-05-22 10:38:08,617 - __main__ - INFO - Request 86e4301c-076f-4b79-a54f-fecf5810241a: Starting payment processing
2025-05-22 10:38:08,653 - __main__ - INFO - Request 653c8eda-e624-4dec-9758-fb71988b42f5: Starting payment processing
2025-05-22 10:38:24,051 - __main__ - INFO - Request b16cab59-9265-402e-a3cd-8839dbbe0f0a: Starting payment processing
2025-05-22 10:38:57,679 - __main__ - INFO - Request 3a28bc31-d904-4102-a16b-f229d0f4a96e: Starting payment processing
2025-05-22 10:38:57,800 - __main__ - INFO - Request 8f6918b8-311a-4d4f-a5cb-098cb1a0d559: Starting payment processing
2025-05-22 10:39:02,676 - __main__ - WARNING - Rate limit exceeded for IP: 127.0.0.1
2025-05-22 10:39:03,215 - __main__ - WARNING - Rate limit exceeded for IP: 127.0.0.1
2025-05-22 10:39:31,437 - __main__ - INFO - Request cc6345e5-61bb-4fe0-8480-7a7a213f7b81: Starting payment processing
2025-05-22 10:41:39,082 - __main__ - INFO - Request 6395d4a3-3e46-4306-a6fa-8b9ed29af695: Starting payment processing
2025-05-22 10:41:39,338 - __main__ - INFO - Request f905aabf-7230-4cbb-8f66-5082d11e4392: Starting payment processing
2025-05-22 10:42:01,438 - __main__ - INFO - Firebase initialized successfully
2025-05-22 10:42:01,439 - __main__ - INFO - Starting payment server
2025-05-22 10:43:01,742 - __main__ - INFO - Request bcdf9036-4352-4fc1-9fd0-3b68f15fa556: Starting payment processing
2025-05-22 10:43:01,854 - __main__ - INFO - Request 6d8a4cf0-bb42-4e4d-9e1e-d8e969edf6d1: Starting payment processing
2025-05-22 10:43:08,658 - __main__ - INFO - Processing payment for lesson ARoQgqIxEPB4jslMEUAQ: 0.07 ZMW from 0981410178
2025-05-22 10:43:08,841 - __main__ - INFO - Processing payment for lesson ARoQgqIxEPB4jslMEUAQ: 0.07 ZMW from 0981410178
2025-05-22 10:43:09,610 - __main__ - ERROR - Payment processing failed: 403 Client Error: Forbidden for url: https://api-sandbox.ctechpay.com/airtel/access/
2025-05-22 10:43:09,611 - __main__ - ERROR - Request 6d8a4cf0-bb42-4e4d-9e1e-d8e969edf6d1: Error 159536ae-48e7-4f9c-b208-878cc0484d5b: 403 Client Error: Forbidden for url: https://api-sandbox.ctechpay.com/airtel/access/
2025-05-22 10:43:09,646 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\Miles kayler\Documents\ProjectBloom\src\payments.py", line 230, in process_payment
    transaction_data = PaymentProcessor.process_payment(student_phone, tutor_phone, amount, lesson_id)
  File "C:\Users\Miles kayler\Documents\ProjectBloom\src\payments.py", line 138, in process_payment
    response.raise_for_status()
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 403 Client Error: Forbidden for url: https://api-sandbox.ctechpay.com/airtel/access/

2025-05-22 10:43:09,721 - __main__ - ERROR - Payment processing failed: 403 Client Error: Forbidden for url: https://api-sandbox.ctechpay.com/airtel/access/
2025-05-22 10:43:09,723 - __main__ - ERROR - Request bcdf9036-4352-4fc1-9fd0-3b68f15fa556: Error 6510aa52-8d1c-4a25-b3b7-047ecaa6cd9d: 403 Client Error: Forbidden for url: https://api-sandbox.ctechpay.com/airtel/access/
2025-05-22 10:43:09,759 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\Miles kayler\Documents\ProjectBloom\src\payments.py", line 230, in process_payment
    transaction_data = PaymentProcessor.process_payment(student_phone, tutor_phone, amount, lesson_id)
  File "C:\Users\Miles kayler\Documents\ProjectBloom\src\payments.py", line 138, in process_payment
    response.raise_for_status()
  File "C:\Users\Miles kayler\AppData\Local\Programs\Python\Python310\lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 403 Client Error: Forbidden for url: https://api-sandbox.ctechpay.com/airtel/access/

2025-05-22 17:44:09,958 - __main__ - INFO - Firebase initialized successfully
2025-05-22 17:44:09,960 - __main__ - INFO - Starting payment server
2025-05-22 17:45:28,713 - __main__ - INFO - Request 605af5ff-3a1a-46ef-b026-0b80b7f0eff8: Starting payment processing
2025-05-22 17:45:36,140 - __main__ - INFO - Processing payment for lesson ARoQgqIxEPB4jslMEUAQ: 0.94 ZMW from +265981410178
2025-05-22 17:45:36,141 - __main__ - INFO - Request payload: {'airtel': '1', 'token': 'ddd95f652a068277977104da91f186fe', 'amount': '0.94', 'phone': '+265981410178'}
2025-05-22 17:45:37,805 - __main__ - INFO - API response: 403 - <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>403 Forbidden</title>
</head><body>
<h1>Forbidden</h1>
<p>You don't have permission to access this resource.</p>
</body></html>

2025-05-22 17:45:37,811 - __main__ - ERROR - Payment processing failed: 403 Client Error: Forbidden for url: https://api-sandbox.ctechpay.com/airtel/access/
2025-05-22 17:45:37,813 - __main__ - WARNING - Request 605af5ff-3a1a-46ef-b026-0b80b7f0eff8: Validation error: Payment failed: 403 Client Error: Forbidden for url: https://api-sandbox.ctechpay.com/airtel/access/
2025-05-22 22:09:12,108 - __main__ - INFO - Firebase initialized successfully
2025-05-22 22:09:12,109 - __main__ - INFO - Starting payment server
2025-05-22 22:10:59,068 - __main__ - ERROR - Request validation error: process_payment() missing 4 required positional arguments: 'student_phone', 'tutor_phone', 'amount', and 'lesson_id'
2025-05-22 22:10:59,234 - __main__ - ERROR - Request validation error: process_payment() missing 4 required positional arguments: 'student_phone', 'tutor_phone', 'amount', and 'lesson_id'
2025-05-22 22:13:33,085 - __main__ - INFO - Firebase initialized successfully
2025-05-22 22:13:33,087 - __main__ - INFO - Starting payment server
2025-05-22 22:14:29,503 - __main__ - INFO - Request 732a005f-7215-40b6-b588-686854dd4e71: Starting payment processing
2025-05-22 22:15:30,534 - __main__ - INFO - Request d3ff2b5d-5edc-4dca-b2c4-22c1053daa53: Starting payment processing
2025-05-22 22:15:30,542 - __main__ - INFO - Request 3dd56bc3-2811-4300-9b98-1470c60d4ebb: Starting payment processing
2025-05-22 22:15:30,551 - __main__ - INFO - Request 55c63292-d056-44c3-b16f-77acb447804c: Starting payment processing
2025-05-22 22:15:36,006 - __main__ - INFO - Processing payment for lesson ARoQgqIxEPB4jslMEUAQ: 0.05 ZMW from +265981410178
2025-05-22 22:15:36,007 - __main__ - INFO - Request payload: {'airtel': '1', 'token': 'ddd95f652a068277977104da91f186fe', 'amount': '0.05', 'phone': '+265981410178'}
2025-05-22 22:15:36,009 - __main__ - INFO - Processing payment for lesson ARoQgqIxEPB4jslMEUAQ: 0.07 ZMW from +265981410178
2025-05-22 22:15:36,016 - __main__ - INFO - Request payload: {'airtel': '1', 'token': 'ddd95f652a068277977104da91f186fe', 'amount': '0.07', 'phone': '+265981410178'}
2025-05-22 22:15:36,531 - __main__ - INFO - Processing payment for lesson ARoQgqIxEPB4jslMEUAQ: 0.05 ZMW from +265981410178
2025-05-22 22:15:36,542 - __main__ - INFO - Request payload: {'airtel': '1', 'token': 'ddd95f652a068277977104da91f186fe', 'amount': '0.05', 'phone': '+265981410178'}
2025-05-22 22:15:37,608 - __main__ - INFO - Processing payment for lesson ARoQgqIxEPB4jslMEUAQ: 0.07 ZMW from +265981410178
2025-05-22 22:15:37,614 - __main__ - INFO - Request payload: {'airtel': '1', 'token': 'ddd95f652a068277977104da91f186fe', 'amount': '0.07', 'phone': '+265981410178'}
2025-05-22 22:15:37,676 - __main__ - INFO - API response: 403 - <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>403 Forbidden</title>
</head><body>
<h1>Forbidden</h1>
<p>You don't have permission to access this resource.</p>
</body></html>

2025-05-22 22:15:37,677 - __main__ - INFO - API response: 403 - <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>403 Forbidden</title>
</head><body>
<h1>Forbidden</h1>
<p>You don't have permission to access this resource.</p>
</body></html>

2025-05-22 22:15:37,679 - __main__ - INFO - API response: 403 - <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>403 Forbidden</title>
</head><body>
<h1>Forbidden</h1>
<p>You don't have permission to access this resource.</p>
</body></html>

2025-05-22 22:15:37,685 - __main__ - ERROR - Payment processing failed: 403 Client Error: Forbidden for url: https://api-sandbox.ctechpay.com/airtel/access/
2025-05-22 22:15:37,692 - __main__ - ERROR - Payment processing failed: 403 Client Error: Forbidden for url: https://api-sandbox.ctechpay.com/airtel/access/
2025-05-22 22:15:37,698 - __main__ - ERROR - Payment processing failed: 403 Client Error: Forbidden for url: https://api-sandbox.ctechpay.com/airtel/access/
2025-05-22 22:15:37,699 - __main__ - WARNING - Request d3ff2b5d-5edc-4dca-b2c4-22c1053daa53: Validation error: Payment failed: 403 Client Error: Forbidden for url: https://api-sandbox.ctechpay.com/airtel/access/
2025-05-22 22:15:37,701 - __main__ - WARNING - Request 3dd56bc3-2811-4300-9b98-1470c60d4ebb: Validation error: Payment failed: 403 Client Error: Forbidden for url: https://api-sandbox.ctechpay.com/airtel/access/
2025-05-22 22:15:37,727 - __main__ - WARNING - Request 55c63292-d056-44c3-b16f-77acb447804c: Validation error: Payment failed: 403 Client Error: Forbidden for url: https://api-sandbox.ctechpay.com/airtel/access/
2025-05-22 22:15:38,500 - __main__ - INFO - API response: 403 - <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>403 Forbidden</title>
</head><body>
<h1>Forbidden</h1>
<p>You don't have permission to access this resource.</p>
</body></html>

2025-05-22 22:15:38,501 - __main__ - ERROR - Payment processing failed: 403 Client Error: Forbidden for url: https://api-sandbox.ctechpay.com/airtel/access/
2025-05-22 22:15:38,507 - __main__ - WARNING - Request 732a005f-7215-40b6-b588-686854dd4e71: Validation error: Payment failed: 403 Client Error: Forbidden for url: https://api-sandbox.ctechpay.com/airtel/access/
2025-05-22 22:19:01,362 - __main__ - INFO - Firebase initialized successfully
2025-05-22 22:19:01,363 - __main__ - INFO - Starting payment server
2025-05-22 22:19:40,743 - __main__ - ERROR - Request validation error: process_payment() missing 4 required positional arguments: 'student_phone', 'tutor_phone', 'amount', and 'lesson_id'
2025-05-22 22:21:13,912 - __main__ - ERROR - Request validation error: process_payment() missing 4 required positional arguments: 'student_phone', 'tutor_phone', 'amount', and 'lesson_id'
2025-05-22 22:23:40,062 - __main__ - INFO - Firebase initialized successfully
2025-05-22 22:23:40,064 - __main__ - INFO - Starting payment server
2025-05-22 22:24:22,056 - __main__ - INFO - Request 7d11eacc-7910-482a-ab01-1cb4798975fd: Starting payment processing
2025-05-22 22:24:29,361 - __main__ - INFO - Requesting access token for lesson ARoQgqIxEPB4jslMEUAQ
2025-05-22 22:24:30,105 - __main__ - INFO - Token API response: 400 - {"error_description":"Invalid client authentication","error":"invalid_client"}
2025-05-22 22:24:30,107 - __main__ - ERROR - Payment processing failed: 400 Client Error: Bad Request for url: https://openapiuat.airtel.africa/auth/oauth2/token
2025-05-22 22:24:30,108 - __main__ - WARNING - Request 7d11eacc-7910-482a-ab01-1cb4798975fd: Validation error: Payment failed: 400 Client Error: Bad Request for url: https://openapiuat.airtel.africa/auth/oauth2/token
2025-05-22 22:29:08,954 - __main__ - INFO - Firebase initialized successfully
2025-05-22 22:29:08,956 - __main__ - INFO - Starting payment server
2025-05-22 22:31:55,243 - __main__ - INFO - Request 20b8f45b-1516-4ca3-80dc-0dc1fa66d281: Starting payment processing
2025-05-22 22:32:02,180 - __main__ - INFO - Requesting access token for lesson ARoQgqIxEPB4jslMEUAQ with client_id: 41dcbbf6-55ac-4558-ab38-8d197a669099
2025-05-22 22:32:02,923 - __main__ - INFO - Token API response: 400 - {"error_description":"Invalid client authentication","error":"invalid_client"}
2025-05-22 22:32:02,924 - __main__ - ERROR - Payment processing failed: 400 Client Error: Bad Request for url: https://openapiuat.airtel.africa/auth/oauth2/token
2025-05-22 22:32:02,925 - __main__ - WARNING - Request 20b8f45b-1516-4ca3-80dc-0dc1fa66d281: Validation error: Payment failed: 400 Client Error: Bad Request for url: https://openapiuat.airtel.africa/auth/oauth2/token
2025-05-22 22:47:15,650 - __main__ - INFO - Request d420366e-d470-4e1a-affb-6fd8cf2831f2: Starting payment processing
2025-05-22 22:47:15,937 - __main__ - INFO - Request 1dce7d5c-02aa-4ebb-bcfd-f6b5e30c4b47: Starting payment processing
2025-05-22 22:47:16,172 - __main__ - INFO - Request be5523a3-2a2b-4127-9b73-a3b4304da29d: Starting payment processing
2025-05-22 22:47:21,523 - __main__ - INFO - Requesting access token for lesson ARoQgqIxEPB4jslMEUAQ with client_id: 41dcbbf6-55ac-4558-ab38-8d197a669099
2025-05-22 22:47:21,725 - __main__ - INFO - Requesting access token for lesson ARoQgqIxEPB4jslMEUAQ with client_id: 41dcbbf6-55ac-4558-ab38-8d197a669099
2025-05-22 22:47:22,401 - __main__ - INFO - Token API response: 400 - {"error_description":"Invalid client authentication","error":"invalid_client"}
2025-05-22 22:47:22,404 - __main__ - INFO - Token API response: 400 - {"error_description":"Invalid client authentication","error":"invalid_client"}
2025-05-22 22:47:22,405 - __main__ - ERROR - Payment processing failed: 400 Client Error: Bad Request for url: https://openapiuat.airtel.africa/auth/oauth2/token
2025-05-22 22:47:22,406 - __main__ - ERROR - Payment processing failed: 400 Client Error: Bad Request for url: https://openapiuat.airtel.africa/auth/oauth2/token
2025-05-22 22:47:22,407 - __main__ - WARNING - Request 1dce7d5c-02aa-4ebb-bcfd-f6b5e30c4b47: Validation error: Payment failed: 400 Client Error: Bad Request for url: https://openapiuat.airtel.africa/auth/oauth2/token
2025-05-22 22:47:22,407 - __main__ - WARNING - Request be5523a3-2a2b-4127-9b73-a3b4304da29d: Validation error: Payment failed: 400 Client Error: Bad Request for url: https://openapiuat.airtel.africa/auth/oauth2/token
2025-05-22 22:47:22,983 - __main__ - INFO - Requesting access token for lesson ARoQgqIxEPB4jslMEUAQ with client_id: 41dcbbf6-55ac-4558-ab38-8d197a669099
2025-05-22 22:47:23,563 - __main__ - INFO - Token API response: 400 - {"error_description":"Invalid client authentication","error":"invalid_client"}
2025-05-22 22:47:23,564 - __main__ - ERROR - Payment processing failed: 400 Client Error: Bad Request for url: https://openapiuat.airtel.africa/auth/oauth2/token
2025-05-22 22:47:23,565 - __main__ - WARNING - Request d420366e-d470-4e1a-affb-6fd8cf2831f2: Validation error: Payment failed: 400 Client Error: Bad Request for url: https://openapiuat.airtel.africa/auth/oauth2/token
2025-05-27 18:36:18,338 - __main__ - INFO - Firebase initialized successfully
2025-05-27 18:36:19,366 - __main__ - INFO - Starting payment server
2025-05-27 20:51:02,464 - __main__ - INFO - Request 0c011740-5fd1-42c3-8525-d8014536fab5: Starting payment processing
2025-05-27 20:51:19,756 - __main__ - INFO - Requesting access token for lesson FBsgwpEIFTGSEpJ9wczG with client_id: 41dcbbf6-55ac-4558-ab38-8d197a669099
2025-05-27 20:51:19,867 - __main__ - INFO - Token request payload: {'client_id': '41dcbbf6-55ac-4558-ab38-8d197a669099', 'client_secret': '****************************', 'grant_type': 'client_credentials'}
2025-05-27 20:51:19,965 - __main__ - INFO - Token request headers: {'Content-Type': 'application/x-www-form-urlencoded', 'Accept': '*/*'}
2025-05-27 20:51:21,676 - __main__ - INFO - Token API response: 400 - {"error_description":"Invalid client authentication","error":"invalid_client"}
2025-05-27 20:51:21,680 - __main__ - ERROR - Payment processing failed: 400 Client Error: Bad Request for url: https://openapiuat.airtel.africa/auth/oauth2/token
2025-05-27 20:51:21,682 - __main__ - WARNING - Request 0c011740-5fd1-42c3-8525-d8014536fab5: Validation error: Payment failed: 400 Client Error: Bad Request for url: https://openapiuat.airtel.africa/auth/oauth2/token
2025-05-27 22:07:26,812 - __main__ - CRITICAL - PAYCHANGU_PUBLIC_KEY is missing
2025-05-27 22:08:19,427 - __main__ - INFO - Firebase initialized successfully
2025-05-27 22:08:19,434 - __main__ - INFO - Starting payment server
2025-05-27 22:17:27,757 - __main__ - INFO - Firebase initialized successfully
2025-05-27 22:17:27,865 - __main__ - INFO - Starting payment server
2025-05-27 22:25:29,565 - __main__ - INFO - Firebase initialized successfully
2025-05-27 22:25:29,568 - __main__ - INFO - Starting payment server
2025-05-27 22:27:21,299 - __main__ - INFO - Request 3a6bce06-2bcd-4ea2-ae24-a4305cd97d1f: Starting payment processing
2025-05-27 22:27:32,850 - __main__ - INFO - Generated PayChangu payment script for lesson FBsgwpEIFTGSEpJ9wczG, tx_ref: LESSON_FBsgwpEIFTGSEpJ9wczG_4f1f4a2d
2025-05-27 22:27:33,589 - __main__ - INFO - Payment record saved: 6ba05396-5fbd-4a3e-b113-ec9ce05db437
2025-05-27 22:27:33,590 - __main__ - INFO - Request 3a6bce06-2bcd-4ea2-ae24-a4305cd97d1f: Payment initiated in 12.29s
2025-05-27 22:58:56,854 - __main__ - INFO - Request 71268127-07c4-4fe4-820d-5bbe27f88368: Starting payment processing
2025-05-27 22:59:02,216 - __main__ - INFO - Generated PayChangu payment script for lesson FBsgwpEIFTGSEpJ9wczG, tx_ref: LESSON_FBsgwpEIFTGSEpJ9wczG_46e986fe
2025-05-27 22:59:02,749 - __main__ - INFO - Payment record saved: f6833498-f920-4f81-932d-6c2a3bec21d5
2025-05-27 22:59:02,751 - __main__ - INFO - Request 71268127-07c4-4fe4-820d-5bbe27f88368: Payment initiated in 5.90s
2025-05-27 23:00:55,398 - __main__ - INFO - Request cf5585bf-c4e4-4d96-a699-5c117a648d4b: Starting payment processing
2025-05-27 23:00:59,036 - __main__ - INFO - Generated PayChangu payment script for lesson FBsgwpEIFTGSEpJ9wczG, tx_ref: LESSON_FBsgwpEIFTGSEpJ9wczG_31839702
2025-05-27 23:00:59,531 - __main__ - INFO - Payment record saved: f5fa3225-e90e-41e5-ad85-13ed5e157e08
2025-05-27 23:00:59,532 - __main__ - INFO - Request cf5585bf-c4e4-4d96-a699-5c117a648d4b: Payment initiated in 4.13s
2025-05-27 23:11:26,607 - __main__ - INFO - Request 6ba4adad-44af-4948-a5a6-ac5b9bb4a7d3: Starting payment processing
2025-05-27 23:11:31,738 - __main__ - INFO - Generated PayChangu payment script for lesson FBsgwpEIFTGSEpJ9wczG, tx_ref: LESSON_FBsgwpEIFTGSEpJ9wczG_a96165ed
2025-05-27 23:11:32,238 - __main__ - INFO - Payment record saved: 125a4609-e95a-4d28-9107-b725c38f8326
2025-05-27 23:11:32,239 - __main__ - INFO - Request 6ba4adad-44af-4948-a5a6-ac5b9bb4a7d3: Payment initiated in 5.64s
2025-05-27 23:26:37,584 - __main__ - CRITICAL - PAYCHANGU_PUBLIC_KEY or PAYCHANGU_SECRET_KEY is missing
2025-05-27 23:29:49,156 - __main__ - INFO - Firebase initialized successfully
2025-05-27 23:29:49,161 - __main__ - INFO - Starting payment server
2025-05-27 23:31:12,554 - __main__ - INFO - Request ccc0bccc-82b0-4e64-b776-af426cb66225: Starting payment processing
2025-05-27 23:31:22,286 - __main__ - INFO - AI agent processing payment for lesson FBsgwpEIFTGSEpJ9wczG
2025-05-27 23:31:23,203 - __main__ - WARNING - No payment method found for student 06ykBrbECLOSocrUDqyI4UpyHnF3
2025-05-27 23:31:23,233 - __main__ - ERROR - Server-side payment processing failed: No payment method available for student
2025-05-27 23:31:23,282 - __main__ - ERROR - AI payment processing failed: Server-side payment processing failed: No payment method available for student
2025-05-27 23:31:23,287 - __main__ - WARNING - Request ccc0bccc-82b0-4e64-b776-af426cb66225: Validation error: Server-side payment processing failed: No payment method available for student
2025-05-27 23:31:57,844 - __main__ - INFO - Request 0293e68b-427a-47c5-b98d-055070dea021: Starting payment processing
2025-05-27 23:32:03,761 - __main__ - INFO - AI agent processing payment for lesson FBsgwpEIFTGSEpJ9wczG
2025-05-27 23:32:06,364 - __main__ - WARNING - No payment method found for student 06ykBrbECLOSocrUDqyI4UpyHnF3
2025-05-27 23:32:06,728 - __main__ - ERROR - Server-side payment processing failed: No payment method available for student
2025-05-27 23:32:06,801 - __main__ - ERROR - AI payment processing failed: Server-side payment processing failed: No payment method available for student
2025-05-27 23:32:06,880 - __main__ - WARNING - Request 0293e68b-427a-47c5-b98d-055070dea021: Validation error: Server-side payment processing failed: No payment method available for student
2025-05-27 23:51:56,236 - __main__ - INFO - Request 114954ff-3be0-4e82-a35e-5bf38e785f93: Starting payment processing
2025-05-27 23:51:59,432 - __main__ - INFO - AI agent processing payment for lesson FBsgwpEIFTGSEpJ9wczG
2025-05-27 23:51:59,910 - __main__ - WARNING - No payment method found for student 06ykBrbECLOSocrUDqyI4UpyHnF3
2025-05-27 23:51:59,911 - __main__ - ERROR - Server-side payment processing failed: No payment method available for student
2025-05-27 23:51:59,915 - __main__ - ERROR - AI payment processing failed: Server-side payment processing failed: No payment method available for student
2025-05-27 23:51:59,921 - __main__ - WARNING - Request 114954ff-3be0-4e82-a35e-5bf38e785f93: Validation error: Server-side payment processing failed: No payment method available for student
2025-05-27 23:57:49,220 - __main__ - INFO - Firebase initialized successfully
2025-05-27 23:57:49,224 - __main__ - INFO - Starting payment server
2025-05-27 23:59:44,130 - __main__ - INFO - Request 55695527-7879-4708-b840-b22f32ca4b08: Starting payment processing
2025-05-27 23:59:53,371 - __main__ - INFO - Generated PayChangu payment script for lesson FBsgwpEIFTGSEpJ9wczG, tx_ref: LESSON_FBsgwpEIFTGSEpJ9wczG_bfcf797c
2025-05-27 23:59:55,680 - __main__ - INFO - Payment record saved: a20b5080-10ec-40cb-942b-4429da9b0720
2025-05-27 23:59:56,095 - __main__ - INFO - Request 55695527-7879-4708-b840-b22f32ca4b08: Payment initiated in 11.97s
2025-05-28 00:06:55,277 - __main__ - INFO - Firebase initialized successfully
